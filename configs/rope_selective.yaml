# ==========================================
# 实验配置 (Experiment Configuration)
# ==========================================
experiment:
  name: "rope_selective_hard"       # 实验名称，用于区分不同的运行
  seed: 42                          # 随机种子，保证结果可复现
  out_dir: "outputs/rope_selective" # 输出目录，用于保存日志和模型权重

# ==========================================
# 数据配置 (Data Configuration)
# ==========================================
data:
  mode: "selective"                 # 任务模式："selective" 表示选择性计数任务
  vocab_size: 5000                  # 词表大小 (包含特殊 token 和噪声词)
  seq_len: 1024                     # 序列长度 (训练时的上下文窗口)
  
  # 高难度模式参数 (Hard Mode Arguments)
  # 控制指令的复杂度，例如 "Count A and B"
  hard_mode_kwargs:
    min_directives: 1               # 最少统计对象数 (指令复杂度下限)
    max_directives: 2               # 最多统计对象数 (指令复杂度上限)

# ==========================================
# 模型配置 (Model Configuration)
# ==========================================
model:
  type: "gpt"                       # 模型架构类型：标准 GPT
  n_layer: 12                       # Transformer 层数 (深度)
  n_head: 8                         # 注意力头数 (宽度)
  n_embd: 512                       # 嵌入维度 (Hidden Size)
  block_size: 1024                  # 模型支持的最大上下文长度
  
  # 位置编码配置 (Position Encoding)
  position_encoding:
    type: "rope"                    # 使用 RoPE (旋转位置编码)
    
    # RoPE 特有参数
    rope_args:
      max_seq_len: 1024             # 对齐 CoPE 的 npos_max，确保参数配置一致

# ==========================================
# 训练配置 (Training Configuration)
# ==========================================
train:
  batch_size: 4                     # 批次大小 (显存敏感，设为 4 以防 OOM)
  max_steps: 1000                   # 最大训练步数
  lr: 3.0e-4                        # 学习率 (AdamW)
  log_interval: 50                  # 每隔多少步打印一次日志
  eval_interval: 200                # 每隔多少步在验证集上评估一次
  device: "cuda"                    # 训练设备 ("cuda" 或 "cpu")
  distributed: false                # 是否开启多机多卡 (本脚本仅支持单卡或简单的多进程并发)
